<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>第二章   体系结构</title>
      <link href="/2020/04/22/02-mysql-lesson02-ti-xi-jie-gou-yu-guan-li/"/>
      <url>/2020/04/22/02-mysql-lesson02-ti-xi-jie-gou-yu-guan-li/</url>
      
        <content type="html"><![CDATA[<h1 id="1-体系结构"><a href="#1-体系结构" class="headerlink" title="1. 体系结构"></a>1. 体系结构</h1><h2 id="1-1-C-S-客户端-服务端-模型介绍"><a href="#1-1-C-S-客户端-服务端-模型介绍" class="headerlink" title="1.1 C/S(客户端/服务端)模型介绍"></a>1.1 C/S(客户端/服务端)模型介绍</h2><p><img src="https:////upload-images.jianshu.io/upload_images/16956686-301b140a033d0dd2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/712/format/webp" alt="img"></p><p>image</p><pre class="line-numbers language-scss"><code class="language-scss">TCP/IP方式（远程、本地）：mysql -uroot -poldboy<span class="token number">123</span> -h <span class="token number">10.0.0.51</span> -P<span class="token number">3306</span>Socket方式<span class="token punctuation">(</span>仅本地<span class="token punctuation">)</span>：mysql -uroot -poldboy<span class="token number">123</span> -S /tmp/mysql<span class="token number">.</span>sock----------------------------------Linux 中一切皆文件。Linux中一切皆命令。MySQL 中一切皆表。一切皆SQL。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="1-2-实例介绍"><a href="#1-2-实例介绍" class="headerlink" title="1.2 实例介绍"></a>1.2 实例介绍</h2><p>MySQL 逻辑对象的特点</p><pre><code>库 ： 库名 + 库属性表 ： 列(字段：列名，列属性) + 行（记录）+ 表属性</code></pre><pre class="line-numbers language-undefined"><code class="language-undefined">实例=mysqld后台守护进程+Master Thread +干活的Thread+预分配的内存公司=老板+经理+员工+办公室<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="1-3-mysqld程序运行原理"><a href="#1-3-mysqld程序运行原理" class="headerlink" title="1.3 mysqld程序运行原理"></a>1.3 mysqld程序运行原理</h2><h3 id="1-3-1-mysqld程序结构"><a href="#1-3-1-mysqld程序结构" class="headerlink" title="1.3.1 mysqld程序结构"></a>1.3.1 mysqld程序结构</h3><p><img src="https:////upload-images.jianshu.io/upload_images/16956686-7824255ca53f23e5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/645/format/webp" alt="img"></p><p>image</p><h3 id="1-3-2-一条SQL语句的执行过程"><a href="#1-3-2-一条SQL语句的执行过程" class="headerlink" title="1.3.2 一条SQL语句的执行过程"></a>1.3.2 一条SQL语句的执行过程</h3><pre class="line-numbers language-ruby"><code class="language-ruby"><span class="token number">1.3</span><span class="token punctuation">.</span><span class="token number">2.1</span> 连接层（<span class="token number">1</span>）提供连接协议：<span class="token constant">TCP</span><span class="token operator">/</span><span class="token constant">IP</span> 、<span class="token constant">SOCKET</span>（<span class="token number">2</span>）提供验证：用户、密码，<span class="token constant">IP</span>，<span class="token constant">SOCKET</span>（<span class="token number">3</span>）提供专用连接线程：接收用户<span class="token constant">SQL</span>，返回结果通过以下语句可以查看到连接线程基本情况mysql<span class="token operator">></span> show processlist<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>1.3.2.2 SQL层 （重点）</p><pre class="line-numbers language-undefined"><code class="language-undefined">（1）接收上层传送的SQL语句（2）语法验证模块：验证语句语法,是否满足SQL_MODE（3）语义检查：判断SQL语句的类型DDL ：数据定义语言DCL ：数据控制语言DML ：数据操作语言DQL： 数据查询语言...（4）权限检查：用户对库表有没有权限（5）解析器：对语句执行前,进行预处理，生成解析树(执行计划),说白了就是生成多种执行方案.（6）优化器：根据解析器得出的多种执行计划，进行判断，选择最优的执行计划        代价模型：资源（CPU IO MEM）的耗损评估性能好坏（7）执行器：根据最优执行计划，执行SQL语句，产生执行结果执行结果：在磁盘的xxxx位置上（8）提供查询缓存（默认是没开启的），会使用redis tair替代查询缓存功能（9）提供日志记录（日志管理章节）：binlog，默认是没开启的。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>1.3.2.3 存储引擎层（类似于Linux中的文件系统）</p><pre class="line-numbers language-undefined"><code class="language-undefined">负责根据SQL层执行的结果，从磁盘上拿数据。将16进制的磁盘数据，交由SQL结构化化成表，连接层的专用线程返回给用户。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="1-4-逻辑结构"><a href="#1-4-逻辑结构" class="headerlink" title="1.4 逻辑结构"></a>1.4 逻辑结构</h2><p><img src="https:////upload-images.jianshu.io/upload_images/16956686-127fff46fdb7fea9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/505/format/webp" alt="img"></p><p>image.png</p><p><strong>以上图片由五行哥提供</strong></p><h3 id="1-4-1-库："><a href="#1-4-1-库：" class="headerlink" title="1.4.1 库："></a>1.4.1 库：</h3><pre class="line-numbers language-undefined"><code class="language-undefined">库名，库属性<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="1-4-2-表"><a href="#1-4-2-表" class="headerlink" title="1.4.2 表"></a>1.4.2 表</h3><p>微观</p><pre class="line-numbers language-spreadsheet"><code class="language-spreadsheet">扇区、OS block、PAGE、extents 设计理念，都是为了能够程序  -----> OS -----> HDISK 从逻辑操作，到物理操作都能够保证尽可能“连续”IO。段 ： segments , 一个表就是一个段，由1-N个区构成。区 ： extents,  又被称之为“簇”，由64个连续的PAGE构成。默认大小1M。页 :  PAGE，MySQL 最小IO单元，默认大小 16KB，连续的4个OS block。OS block : 文件系统块，默认是4KB，连续的8个扇区。扇区     ： 默认512字节，连续的512字节长度的磁盘区域。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-undefined"><code class="language-undefined">表名属性列:列名(字段),列属性(数据类型,约束等)数据行(记录)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h2 id="1-5-物理存储结构引入"><a href="#1-5-物理存储结构引入" class="headerlink" title="1.5 物理存储结构引入"></a>1.5 物理存储结构引入</h2><p><img src="https:////upload-images.jianshu.io/upload_images/16956686-bfd40838aef7971b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/973/format/webp" alt="img"></p><p>image.png</p><p><strong>以上图片由五行哥提供</strong></p><h3 id="1-5-1-库的物理存储结构"><a href="#1-5-1-库的物理存储结构" class="headerlink" title="1.5.1 库的物理存储结构"></a>1.5.1 库的物理存储结构</h3><pre class="line-numbers language-undefined"><code class="language-undefined">用文件系统的目录来存储<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="1-5-2-表的物理存储结构"><a href="#1-5-2-表的物理存储结构" class="headerlink" title="1.5.2 表的物理存储结构"></a>1.5.2 表的物理存储结构</h3><pre class="line-numbers language-css"><code class="language-css">MyISAM（一种引擎）的表：-rw-r----- <span class="token number">1</span> mysql mysql   <span class="token number">10816</span> Apr <span class="token number">18</span> <span class="token property">11</span><span class="token punctuation">:</span><span class="token number">37</span> user<span class="token number">.</span>frm-rw-r----- <span class="token number">1</span> mysql mysql     <span class="token number">396</span> Apr <span class="token number">18</span> <span class="token property">12</span><span class="token punctuation">:</span><span class="token number">20</span>  user<span class="token number">.</span>MYD-rw-r----- <span class="token number">1</span> mysql mysql    <span class="token number">4096</span> Apr <span class="token number">18</span> <span class="token property">14</span><span class="token punctuation">:</span><span class="token number">48</span> user<span class="token number">.</span>MYI<span class="token function">InnoDB</span><span class="token punctuation">(</span>默认的存储引擎<span class="token punctuation">)</span>的表：-rw-r----- <span class="token number">1</span> mysql mysql    <span class="token number">8636</span> Apr <span class="token number">18</span> <span class="token property">11</span><span class="token punctuation">:</span><span class="token number">37</span> time_zone<span class="token number">.</span>frm-rw-r----- <span class="token number">1</span> mysql mysql   <span class="token number">98304</span> Apr <span class="token number">18</span> <span class="token property">11</span><span class="token punctuation">:</span><span class="token number">37</span> time_zone<span class="token number">.</span>ibdtime_zone<span class="token number">.</span>frm：存储列相关信息time_zone<span class="token number">.</span>ibd：数据行+索引<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="1-5-3-表的段、区、页（16k）（了解）"><a href="#1-5-3-表的段、区、页（16k）（了解）" class="headerlink" title="1.5.3 表的段、区、页（16k）（了解）"></a>1.5.3 表的段、区、页（16k）（了解）</h3><pre class="line-numbers language-undefined"><code class="language-undefined">页：最小的存储单元，默认16k区：64个连续的页，共1M段：一个表就是一个段，包含一个或多个区<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h1 id="2-基础管理"><a href="#2-基础管理" class="headerlink" title="2. 基础管理"></a>2. 基础管理</h1><h2 id="2-1-用户、权限管理"><a href="#2-1-用户、权限管理" class="headerlink" title="2.1 用户、权限管理"></a>2.1 用户、权限管理</h2><h3 id="2-1-1-用户"><a href="#2-1-1-用户" class="headerlink" title="2.1.1 用户"></a>2.1.1 用户</h3><h3 id="2-查询"><a href="#2-查询" class="headerlink" title="2-查询"></a>2-查询</h3><pre><code>mysql&gt; select user,host ,authentication_string ,plugin from mysql.user;mysql&gt; desc mysql.user;    -- 查询表定义</code></pre><p>作用：</p><pre class="line-numbers language-undefined"><code class="language-undefined">登录，管理数据库逻辑对象<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>定义：</p><pre class="line-numbers language-kotlin"><code class="language-kotlin">用户名@<span class="token string">'白名单'</span>白名单支持的方式？<span class="token label symbol">wordpress@</span><span class="token string">'10.0.0.%'</span>    <span class="token label symbol">wordpress@</span><span class="token string">'%'</span><span class="token label symbol">wordpress@</span><span class="token string">'10.0.0.200'</span><span class="token label symbol">wordpress@</span><span class="token string">'localhost'</span><span class="token label symbol">wordpress@</span><span class="token string">'db02'</span><span class="token label symbol">wordpress@</span><span class="token string">'10.0.0.5%'</span><span class="token label symbol">wordpress@</span><span class="token string">'10.0.0.0/255.255.254.0'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>管理操作：</p><pre class="line-numbers language-css"><code class="language-css">增：mysql> create user oldboy@<span class="token string">'10.0.0.%'</span> identified by <span class="token string">'123'</span><span class="token punctuation">;</span>查：mysql> desc mysql<span class="token number">.</span>user<span class="token punctuation">;</span>    ---->  authentication_stringmysql> select user ,host ,authentication_string from mysql<span class="token number">.</span>user改<span class="token punctuation">:</span>mysql> alter user oldboy@<span class="token string">'10.0.0.%'</span> identified by <span class="token string">'456'</span><span class="token punctuation">;</span>删：mysql> drop user oldboy@<span class="token string">'10.0.0.%'</span><span class="token punctuation">;</span>用户锁定 ACCOUNT LOCK    ACCOUNT UNLOCK        mysql> alter user test@<span class="token string">'10.0.0.%'</span> ACCOUNT LOCK<span class="token punctuation">;</span>    mysql> alter user test@<span class="token string">'10.0.0.%'</span> ACCOUNT UNLOCK<span class="token punctuation">;</span>    ## 密码过期 （了解）    alter user oldboy@<span class="token string">'10.0.0.%'</span> PASSWORD EXPIRE<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="2-1-2-权限"><a href="#2-1-2-权限" class="headerlink" title="2.1.2 权限"></a>2.1.2 权限</h3><p>权限管理操作：</p><pre class="line-numbers language-css"><code class="language-css">mysql> grant all on wordpress<span class="token number">.</span>* to wordpress@<span class="token string">'10.0.0.%'</span> identified  by <span class="token string">'123'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>常用权限介绍:</p><pre class="line-numbers language-dart"><code class="language-dart">ALL<span class="token punctuation">:</span>SELECT<span class="token punctuation">,</span>INSERT<span class="token punctuation">,</span> UPDATE<span class="token punctuation">,</span> DELETE<span class="token punctuation">,</span> CREATE<span class="token punctuation">,</span> DROP<span class="token punctuation">,</span> RELOAD<span class="token punctuation">,</span> SHUTDOWN<span class="token punctuation">,</span> PROCESS<span class="token punctuation">,</span> FILE<span class="token punctuation">,</span> REFERENCES<span class="token punctuation">,</span> INDEX<span class="token punctuation">,</span> ALTER<span class="token punctuation">,</span> SHOW DATABASES<span class="token punctuation">,</span> SUPER<span class="token punctuation">,</span> CREATE TEMPORARY TABLES<span class="token punctuation">,</span> LOCK TABLES<span class="token punctuation">,</span> EXECUTE<span class="token punctuation">,</span> REPLICATION SLAVE<span class="token punctuation">,</span> REPLICATION CLIENT<span class="token punctuation">,</span> CREATE VIEW<span class="token punctuation">,</span> SHOW VIEW<span class="token punctuation">,</span> CREATE ROUTINE<span class="token punctuation">,</span> ALTER ROUTINE<span class="token punctuation">,</span> CREATE USER<span class="token punctuation">,</span> EVENT<span class="token punctuation">,</span> TRIGGER<span class="token punctuation">,</span> CREATE TABLESPACEALL <span class="token punctuation">:</span> 以上所有权限，一般是普通管理员拥有的<span class="token keyword">with</span> grant option：超级管理员才具备的，给别的用户授权的功能<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>权限作用范围:</p><pre class="line-numbers language-rust"><code class="language-rust"><span class="token operator">*</span><span class="token punctuation">.</span><span class="token operator">*</span>                  <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">-></span>管理员用户wordpress<span class="token punctuation">.</span><span class="token operator">*</span>          <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">-></span>开发和应用用户wordpress<span class="token punctuation">.</span>t1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>需求1：windows机器的navicat登录到linux中的MySQL，管理员用户。</p><pre class="line-numbers language-css"><code class="language-css">mysql> grant all on *<span class="token number">.</span>* to root@<span class="token string">'10.0.0.%'</span> identified by <span class="token string">'123'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>需求2：创建一个应用用户app用户，能从windows上登录mysql，并能操作app库</p><pre class="line-numbers language-csharp"><code class="language-csharp">mysql<span class="token operator">></span> grant <span class="token keyword">select</span> <span class="token punctuation">,</span>update<span class="token punctuation">,</span>insert<span class="token punctuation">,</span>delete on app<span class="token punctuation">.</span><span class="token operator">*</span> to app<span class="token string">@'10.0.0.%'</span> identified by <span class="token string">'123'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="2-1-3-开发人员用户授权流程"><a href="#2-1-3-开发人员用户授权流程" class="headerlink" title="2.1.3 开发人员用户授权流程"></a>2.1.3 开发人员用户授权流程</h3><pre class="line-numbers language-undefined"><code class="language-undefined">1.权限2.对谁操作3.你从哪来4.密码要求<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h3 id="2-1-4-提示：8-0在grant命令添加新特性"><a href="#2-1-4-提示：8-0在grant命令添加新特性" class="headerlink" title="2.1.4 提示：8.0在grant命令添加新特性"></a>2.1.4 提示：8.0在grant命令添加新特性</h3><pre class="line-numbers language-undefined"><code class="language-undefined">建用户和授权分开了grant 不再支持自动创建用户了，不支持改密码授权之前，必须要提前创建用户。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="2-1-5-查看授权"><a href="#2-1-5-查看授权" class="headerlink" title="2.1.5 查看授权"></a>2.1.5 查看授权</h3><pre class="line-numbers language-css"><code class="language-css">mysql> show grants for app@<span class="token string">'10.0.0.%'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="2-1-6-回收权限"><a href="#2-1-6-回收权限" class="headerlink" title="2.1.6 回收权限"></a>2.1.6 回收权限</h3><pre class="line-numbers language-csharp"><code class="language-csharp">revoke  delete on app<span class="token punctuation">.</span><span class="token operator">*</span>  <span class="token keyword">from</span> app<span class="token string">@'10.0.0.%'</span>；<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="2-1-7-本地管理员用户密码忘记"><a href="#2-1-7-本地管理员用户密码忘记" class="headerlink" title="2.1.7 本地管理员用户密码忘记."></a>2.1.7 本地管理员用户密码忘记.</h3><pre class="line-numbers language-csharp"><code class="language-csharp"><span class="token punctuation">[</span>root@db01 <span class="token operator">~</span><span class="token punctuation">]</span># mysqld_safe <span class="token operator">--</span>skip<span class="token operator">-</span>grant<span class="token operator">-</span>tables <span class="token operator">--</span>skip<span class="token operator">-</span>networking <span class="token operator">&amp;</span>mysql<span class="token operator">></span> flush privileges<span class="token punctuation">;</span>mysql<span class="token operator">></span>  alter user root<span class="token string">@'localhost'</span> identified by <span class="token string">'123456'</span><span class="token punctuation">;</span><span class="token punctuation">[</span>root@db01 <span class="token operator">~</span><span class="token punctuation">]</span># pkill mysqld<span class="token punctuation">[</span>root@db01 <span class="token operator">~</span><span class="token punctuation">]</span># systemctl start  mysqld<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="2-2-连接管理"><a href="#2-2-连接管理" class="headerlink" title="2.2 连接管理"></a>2.2 连接管理</h2><h3 id="2-2-1-自带客户端命令"><a href="#2-2-1-自带客户端命令" class="headerlink" title="2.2.1 自带客户端命令"></a>2.2.1 自带客户端命令</h3><p>mysql  常用参数：</p><pre class="line-numbers language-ruby"><code class="language-ruby"><span class="token operator">-</span>u                   用户<span class="token operator">-</span>p                   密码<span class="token operator">-</span>h                   <span class="token constant">IP</span><span class="token operator">-</span><span class="token constant">P</span>                   端口<span class="token operator">-</span><span class="token constant">S</span>                   socket文件<span class="token operator">-</span>e                   免交互执行命令<span class="token operator">&lt;</span>                    导入<span class="token constant">SQL</span>脚本<span class="token punctuation">[</span>root<span class="token variable">@db01</span> <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment" spellcheck="true"># mysql -uroot -p -h 10.0.0.51 -P3306</span><span class="token constant">Enter</span> password<span class="token punctuation">:</span>mysql<span class="token operator">></span> select <span class="token variable">@@socket</span><span class="token punctuation">;</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">|</span> <span class="token variable">@@socket</span>        <span class="token operator">|</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">|</span> <span class="token operator">/</span>tmp<span class="token operator">/</span>mysql<span class="token punctuation">.</span>sock <span class="token operator">|</span><span class="token punctuation">[</span>root<span class="token variable">@db01</span> <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment" spellcheck="true"># mysql -uroot -p -S /tmp/mysql.sock</span><span class="token constant">Enter</span> password<span class="token punctuation">:</span><span class="token punctuation">[</span>root<span class="token variable">@db01</span> <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment" spellcheck="true"># mysql -uroot -p -e "select user,host from mysql.user;"</span><span class="token constant">Enter</span> password<span class="token punctuation">:</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">|</span> user          <span class="token operator">|</span> host      <span class="token operator">|</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">|</span> abc          <span class="token operator">|</span> <span class="token number">10.0</span><span class="token punctuation">.</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token operator">%</span>  <span class="token operator">|</span><span class="token operator">|</span> app          <span class="token operator">|</span> <span class="token number">10.0</span><span class="token punctuation">.</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token operator">%</span>  <span class="token operator">|</span><span class="token operator">|</span> root          <span class="token operator">|</span> <span class="token number">10.0</span><span class="token punctuation">.</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token operator">%</span>  <span class="token operator">|</span><span class="token operator">|</span> mysql<span class="token punctuation">.</span>session <span class="token operator">|</span> localhost <span class="token operator">|</span><span class="token operator">|</span> mysql<span class="token punctuation">.</span>sys    <span class="token operator">|</span> localhost <span class="token operator">|</span><span class="token operator">|</span> root          <span class="token operator">|</span> localhost <span class="token operator">|</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token punctuation">[</span>root<span class="token variable">@db01</span> <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment" spellcheck="true">#</span><span class="token punctuation">[</span>root<span class="token variable">@db01</span> <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment" spellcheck="true"># mysql -uroot -p &lt;world.sql</span><span class="token constant">Enter</span> password<span class="token punctuation">:</span><span class="token punctuation">[</span>root<span class="token variable">@db01</span> <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment" spellcheck="true">#</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="2-3-多种启动方式介绍"><a href="#2-3-多种启动方式介绍" class="headerlink" title="2.3 多种启动方式介绍"></a>2.3 多种启动方式介绍</h2><p><img src="https:////upload-images.jianshu.io/upload_images/16956686-54becae60bf4ca48.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/860/format/webp" alt="img"></p><p>image</p><p>提示：</p><pre class="line-numbers language-undefined"><code class="language-undefined">以上多种方式，都可以单独启动MySQL服务mysqld_safe和mysqld一般是在临时维护时使用。另外，从Centos 7系统开始，支持systemd直接调用mysqld的方式进行启动数据库<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="2-4-初始化配置"><a href="#2-4-初始化配置" class="headerlink" title="2.4 初始化配置"></a>2.4 初始化配置</h2><h3 id="2-4-0-作用"><a href="#2-4-0-作用" class="headerlink" title="2.4.0 作用"></a>2.4.0 作用</h3><pre class="line-numbers language-undefined"><code class="language-undefined">控制MySQL的启动影响到客户端的连接<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="2-4-1-初始化配置的方法"><a href="#2-4-1-初始化配置的方法" class="headerlink" title="2.4.1 初始化配置的方法"></a>2.4.1 初始化配置的方法</h3><pre class="line-numbers language-undefined"><code class="language-undefined">预编译**配置文件(所有启动方式)**命令行参数 (仅限于 mysqld_safe mysqld)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="2-4-2-初始配置文件"><a href="#2-4-2-初始配置文件" class="headerlink" title="2.4.2 初始配置文件"></a>2.4.2 初始配置文件</h3><p>初始化配置文件的默认读取路径</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token punctuation">[</span>root@db01 ~<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># mysqld --help --verbose |grep my.cnf</span>/etc/my.cnf /etc/mysql/my.cnf /usr/local/mysql/etc/my.cnf ~/.my.cnf注:默认情况下，MySQL启动时，会依次读取以上配置文件，如果有重复选项，会以最后一个文件设置的为准。但是，如果启动时加入了--defaults-file<span class="token operator">=</span>xxxx时，以上的所有文件都不会读取.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>配置文件的书写方式:</p><pre class="line-numbers language-csharp"><code class="language-csharp"><span class="token punctuation">[</span>标签<span class="token punctuation">]</span>配置项<span class="token operator">=</span>xxxx标签类型：服务端、客户端服务器端标签：<span class="token punctuation">[</span>mysqld<span class="token punctuation">]</span><span class="token punctuation">[</span>mysqld_safe<span class="token punctuation">]</span><span class="token punctuation">[</span>server<span class="token punctuation">]</span>客户端标签：<span class="token punctuation">[</span>mysql<span class="token punctuation">]</span><span class="token punctuation">[</span>mysqldump<span class="token punctuation">]</span><span class="token punctuation">[</span>client<span class="token punctuation">]</span>配置文件的示例展示：<span class="token punctuation">[</span>root@db01 <span class="token operator">~</span><span class="token punctuation">]</span># cat <span class="token operator">/</span>etc<span class="token operator">/</span>my<span class="token punctuation">.</span>cnf<span class="token punctuation">[</span>mysqld<span class="token punctuation">]</span>user<span class="token operator">=</span>mysqlbasedir<span class="token operator">=</span><span class="token operator">/</span>app<span class="token operator">/</span>mysqldatadir<span class="token operator">=</span><span class="token operator">/</span>data<span class="token operator">/</span>mysqlsocket<span class="token operator">=</span><span class="token operator">/</span>tmp<span class="token operator">/</span>mysql<span class="token punctuation">.</span>sockserver_id<span class="token operator">=</span><span class="token number">6</span>port<span class="token operator">=</span><span class="token number">3306</span>log_error<span class="token operator">=</span><span class="token operator">/</span>data<span class="token operator">/</span>mysql<span class="token operator">/</span>mysql<span class="token punctuation">.</span>log<span class="token punctuation">[</span>mysql<span class="token punctuation">]</span>socket<span class="token operator">=</span><span class="token operator">/</span>tmp<span class="token operator">/</span>mysql<span class="token punctuation">.</span>sockprompt<span class="token operator">=</span>Master <span class="token punctuation">[</span>\\d<span class="token punctuation">]</span><span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="2-5-多实例的应用"><a href="#2-5-多实例的应用" class="headerlink" title="2.5 多实例的应用"></a>2.5 多实例的应用</h2><h3 id="2-5-1-准备多个目录"><a href="#2-5-1-准备多个目录" class="headerlink" title="2.5.1 准备多个目录"></a>2.5.1 准备多个目录</h3><pre class="line-numbers language-kotlin"><code class="language-kotlin">mkdir <span class="token operator">-</span>p <span class="token operator">/</span><span class="token keyword">data</span><span class="token operator">/</span><span class="token number">330</span><span class="token punctuation">{</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">}</span><span class="token operator">/</span><span class="token keyword">data</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="2-5-2-准备配置文件"><a href="#2-5-2-准备配置文件" class="headerlink" title="2.5.2 准备配置文件"></a>2.5.2 准备配置文件</h3><pre class="line-numbers language-jsx"><code class="language-jsx">cat <span class="token operator">></span> <span class="token operator">/</span>data<span class="token regex">/3307/my</span><span class="token punctuation">.</span>cnf <span class="token operator">&lt;</span><span class="token operator">&lt;</span>EOF<span class="token punctuation">[</span>mysqld<span class="token punctuation">]</span>basedir<span class="token operator">=</span><span class="token operator">/</span>app<span class="token operator">/</span>mysqldatadir<span class="token operator">=</span><span class="token operator">/</span>data<span class="token operator">/</span><span class="token number">3307</span><span class="token operator">/</span>datasocket<span class="token operator">=</span><span class="token operator">/</span>data<span class="token operator">/</span><span class="token number">3307</span><span class="token operator">/</span>mysql<span class="token punctuation">.</span>socklog_error<span class="token operator">=</span><span class="token operator">/</span>data<span class="token operator">/</span><span class="token number">3307</span><span class="token operator">/</span>mysql<span class="token punctuation">.</span>logport<span class="token operator">=</span><span class="token number">3307</span>server_id<span class="token operator">=</span><span class="token number">7</span>log_bin<span class="token operator">=</span><span class="token operator">/</span>data<span class="token operator">/</span><span class="token number">3307</span><span class="token operator">/</span>mysql<span class="token operator">-</span>binEOFcat <span class="token operator">></span> <span class="token operator">/</span>data<span class="token regex">/3308/my</span><span class="token punctuation">.</span>cnf <span class="token operator">&lt;</span><span class="token operator">&lt;</span>EOF<span class="token punctuation">[</span>mysqld<span class="token punctuation">]</span>basedir<span class="token operator">=</span><span class="token operator">/</span>app<span class="token operator">/</span>mysqldatadir<span class="token operator">=</span><span class="token operator">/</span>data<span class="token operator">/</span><span class="token number">3308</span><span class="token operator">/</span>datasocket<span class="token operator">=</span><span class="token operator">/</span>data<span class="token operator">/</span><span class="token number">3308</span><span class="token operator">/</span>mysql<span class="token punctuation">.</span>socklog_error<span class="token operator">=</span><span class="token operator">/</span>data<span class="token operator">/</span><span class="token number">3308</span><span class="token operator">/</span>mysql<span class="token punctuation">.</span>logport<span class="token operator">=</span><span class="token number">3308</span>server_id<span class="token operator">=</span><span class="token number">8</span>log_bin<span class="token operator">=</span><span class="token operator">/</span>data<span class="token operator">/</span><span class="token number">3308</span><span class="token operator">/</span>mysql<span class="token operator">-</span>binEOFcat <span class="token operator">></span> <span class="token operator">/</span>data<span class="token regex">/3309/my</span><span class="token punctuation">.</span>cnf <span class="token operator">&lt;</span><span class="token operator">&lt;</span>EOF<span class="token punctuation">[</span>mysqld<span class="token punctuation">]</span>basedir<span class="token operator">=</span><span class="token operator">/</span>app<span class="token operator">/</span>mysqldatadir<span class="token operator">=</span><span class="token operator">/</span>data<span class="token operator">/</span><span class="token number">3309</span><span class="token operator">/</span>datasocket<span class="token operator">=</span><span class="token operator">/</span>data<span class="token operator">/</span><span class="token number">3309</span><span class="token operator">/</span>mysql<span class="token punctuation">.</span>socklog_error<span class="token operator">=</span><span class="token operator">/</span>data<span class="token operator">/</span><span class="token number">3309</span><span class="token operator">/</span>mysql<span class="token punctuation">.</span>logport<span class="token operator">=</span><span class="token number">3309</span>server_id<span class="token operator">=</span><span class="token number">9</span>log_bin<span class="token operator">=</span><span class="token operator">/</span>data<span class="token operator">/</span><span class="token number">3309</span><span class="token operator">/</span>mysql<span class="token operator">-</span>binEOF<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="2-5-3-初始化三套数据"><a href="#2-5-3-初始化三套数据" class="headerlink" title="2.5.3 初始化三套数据"></a>2.5.3 初始化三套数据</h3><pre class="line-numbers language-jsx"><code class="language-jsx">mv <span class="token regex">/etc/my</span><span class="token punctuation">.</span>cnf <span class="token regex">/etc/my</span><span class="token punctuation">.</span>cnf<span class="token punctuation">.</span>bakmysqld <span class="token operator">--</span>initialize<span class="token operator">-</span>insecure  <span class="token operator">--</span>user<span class="token operator">=</span>mysql <span class="token operator">--</span>datadir<span class="token operator">=</span><span class="token operator">/</span>data<span class="token operator">/</span><span class="token number">3307</span><span class="token operator">/</span>data <span class="token operator">--</span>basedir<span class="token operator">=</span><span class="token operator">/</span>app<span class="token operator">/</span>mysqlmysqld <span class="token operator">--</span>initialize<span class="token operator">-</span>insecure  <span class="token operator">--</span>user<span class="token operator">=</span>mysql <span class="token operator">--</span>datadir<span class="token operator">=</span><span class="token operator">/</span>data<span class="token operator">/</span><span class="token number">3308</span><span class="token operator">/</span>data <span class="token operator">--</span>basedir<span class="token operator">=</span><span class="token operator">/</span>app<span class="token operator">/</span>mysqlmysqld <span class="token operator">--</span>initialize<span class="token operator">-</span>insecure  <span class="token operator">--</span>user<span class="token operator">=</span>mysql <span class="token operator">--</span>datadir<span class="token operator">=</span><span class="token operator">/</span>data<span class="token operator">/</span><span class="token number">3309</span><span class="token operator">/</span>data <span class="token operator">--</span>basedir<span class="token operator">=</span><span class="token operator">/</span>app<span class="token operator">/</span>mysql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h3 id="2-5-4-systemd管理多实例"><a href="#2-5-4-systemd管理多实例" class="headerlink" title="2.5.4 systemd管理多实例"></a>2.5.4 systemd管理多实例</h3><pre class="line-numbers language-ruby"><code class="language-ruby">cd <span class="token operator">/</span>etc<span class="token operator">/</span>systemd<span class="token operator">/</span>systemcp mysqld<span class="token punctuation">.</span>service mysqld3307<span class="token punctuation">.</span>servicecp mysqld<span class="token punctuation">.</span>service mysqld3308<span class="token punctuation">.</span>servicecp mysqld<span class="token punctuation">.</span>service mysqld3309<span class="token punctuation">.</span>servicevim mysqld3307<span class="token punctuation">.</span>service<span class="token constant">ExecStart</span><span class="token operator">=</span><span class="token operator">/</span>app<span class="token operator">/</span>mysql<span class="token operator">/</span>bin<span class="token operator">/</span>mysqld  <span class="token operator">--</span>defaults<span class="token operator">-</span>file<span class="token operator">=</span><span class="token operator">/</span>data<span class="token operator">/</span><span class="token number">3307</span><span class="token operator">/</span>my<span class="token punctuation">.</span>cnfvim mysqld3308<span class="token punctuation">.</span>service<span class="token constant">ExecStart</span><span class="token operator">=</span><span class="token operator">/</span>app<span class="token operator">/</span>mysql<span class="token operator">/</span>bin<span class="token operator">/</span>mysqld  <span class="token operator">--</span>defaults<span class="token operator">-</span>file<span class="token operator">=</span><span class="token operator">/</span>data<span class="token operator">/</span><span class="token number">3308</span><span class="token operator">/</span>my<span class="token punctuation">.</span>cnfvim mysqld3309<span class="token punctuation">.</span>service<span class="token constant">ExecStart</span><span class="token operator">=</span><span class="token operator">/</span>app<span class="token operator">/</span>mysql<span class="token operator">/</span>bin<span class="token operator">/</span>mysqld  <span class="token operator">--</span>defaults<span class="token operator">-</span>file<span class="token operator">=</span><span class="token operator">/</span>data<span class="token operator">/</span><span class="token number">3309</span><span class="token operator">/</span>my<span class="token punctuation">.</span>cnf<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="2-5-5-授权"><a href="#2-5-5-授权" class="headerlink" title="2.5.5 授权"></a>2.5.5 授权</h3><pre class="line-numbers language-kotlin"><code class="language-kotlin">chown <span class="token operator">-</span>R mysql<span class="token punctuation">.</span>mysql <span class="token operator">/</span><span class="token keyword">data</span><span class="token operator">/</span><span class="token operator">*</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="2-5-6-启动"><a href="#2-5-6-启动" class="headerlink" title="2.5.6 启动"></a>2.5.6 启动</h3><pre class="line-numbers language-css"><code class="language-css">systemctl start mysqld<span class="token number">3307.</span>servicesystemctl start mysqld<span class="token number">3308.</span>servicesystemctl start mysqld<span class="token number">3309.</span>service<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="2-5-7-验证多实例"><a href="#2-5-7-验证多实例" class="headerlink" title="2.5.7 验证多实例"></a>2.5.7 验证多实例</h3><pre class="line-numbers language-kotlin"><code class="language-kotlin">netstat <span class="token operator">-</span>lnp|grep <span class="token number">330</span>mysql <span class="token operator">-</span>S <span class="token operator">/</span><span class="token keyword">data</span><span class="token operator">/</span><span class="token number">3307</span><span class="token operator">/</span>mysql<span class="token punctuation">.</span>sock <span class="token operator">-</span>e <span class="token string">"select @@server_id"</span>mysql <span class="token operator">-</span>S <span class="token operator">/</span><span class="token keyword">data</span><span class="token operator">/</span><span class="token number">3308</span><span class="token operator">/</span>mysql<span class="token punctuation">.</span>sock <span class="token operator">-</span>e <span class="token string">"select @@server_id"</span>mysql <span class="token operator">-</span>S <span class="token operator">/</span><span class="token keyword">data</span><span class="token operator">/</span><span class="token number">3309</span><span class="token operator">/</span>mysql<span class="token punctuation">.</span>sock <span class="token operator">-</span>e <span class="token string">"select @@server_id"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h1 id="3-mysql8-0特性"><a href="#3-mysql8-0特性" class="headerlink" title="3.mysql8.0特性"></a>3.mysql8.0特性</h1><h2 id="1-增加用户"><a href="#1-增加用户" class="headerlink" title="1-增加用户"></a>1-增加用户</h2><pre class="line-numbers language-css"><code class="language-css"> 增加mysql> create user IF NOT EXISTS oldboy@<span class="token string">'10.0.0.%'</span> identified by <span class="token string">'123'</span><span class="token punctuation">;</span>彩蛋： <span class="token number">8.0</span> + 版本新特性：    <span class="token number">1.</span> 必须先建用户，再授权。    以下命令不再被支持：    grant all on *<span class="token number">.</span>* to zabbix@<span class="token string">'%'</span> identified by <span class="token string">'123'</span><span class="token punctuation">;</span>    正确方法：     create user zabbix@<span class="token string">'%'</span> identified by <span class="token string">'123'</span><span class="token punctuation">;</span>    grant all on *<span class="token number">.</span>* to zabbix@<span class="token string">'%'</span><span class="token punctuation">;</span>    <span class="token number">2.</span> <span class="token number">8.0</span>+ 版本，采用了全新的密码加密插件（caching_sha<span class="token number">2</span>_password）    部分场景下，需要将加密插件替换为<span class="token number">5.7</span>版本支持 mysql_native_password    例如：     主从    MHA    客户端软件    配置方法：     create user zabbix@<span class="token string">'%'</span> identified  by <span class="token string">'123'</span><span class="token punctuation">;</span>    grant all on *<span class="token number">.</span>* to zabbix@<span class="token string">'%'</span><span class="token punctuation">;</span>    替换为<span class="token punctuation">:</span>     create user zabbix<span class="token number">2</span>@<span class="token string">'%'</span> identified  with mysql_native_password   by <span class="token string">'123'</span><span class="token punctuation">;</span>    grant all on *<span class="token number">.</span>* to zabbix<span class="token number">2</span>@<span class="token string">'%'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>##2- 修改密码 </p><pre class="line-numbers language-powershell"><code class="language-powershell">alter user oldboy@<span class="token string">'10.0.0.%'</span> identified by <span class="token string">'123456'</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">## 8.0 修改密码插件</span>    alter user zabbix@<span class="token string">'%'</span>  identified with mysql_native_password  by <span class="token string">'123456'</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">## 用户锁定 </span>    ACCOUNT LOCK    ACCOUNT UNLOCK        mysql> alter user test@<span class="token string">'10.0.0.%'</span> ACCOUNT LOCK<span class="token punctuation">;</span>    mysql> alter user test@<span class="token string">'10.0.0.%'</span> ACCOUNT UNLOCK<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">## 密码过期 （了解）</span>    alter user oldboy@<span class="token string">'10.0.0.%'</span> PASSWORD EXPIRE<span class="token punctuation">;</span><span class="token comment" spellcheck="true"># 删除 </span>    mysql> drop user test@<span class="token string">'10.0.0.%'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="3-权限的定义"><a href="#3-权限的定义" class="headerlink" title="3-权限的定义"></a>3-权限的定义</h2><pre><code>MySQL : 8.0 以前，以命令为授权粒度。8.0 以后，加入了role（角色）方式授权。通过以下命令，可以查看可授权的列表mysql&gt; show privileges;8.0 中角色(role)功能    # 创建角色： CREATE ROLE &#39;app_developer&#39;, &#39;app_read&#39;, &#39;app_write&#39;;    # 角色授权：GRANT ALL ON app_db.* TO &#39;app_developer&#39;;GRANT SELECT ON app_db.* TO &#39;app_read&#39;;GRANT INSERT, UPDATE, DELETE ON app_db.* TO &#39;app_write&#39;;    # 创建用户： CREATE USER &#39;dev1&#39;@&#39;localhost&#39; IDENTIFIED BY &#39;dev1pass&#39;;CREATE USER &#39;read_user1&#39;@&#39;localhost&#39; IDENTIFIED BY &#39;read_user1pass&#39;;CREATE USER &#39;read_user2&#39;@&#39;localhost&#39; IDENTIFIED BY &#39;read_user2pass&#39;;CREATE USER &#39;rw_user1&#39;@&#39;localhost&#39; IDENTIFIED BY &#39;rw_user1pass&#39;;    # 授权用户角色GRANT &#39;app_developer&#39; TO &#39;dev1&#39;@&#39;localhost&#39;;GRANT &#39;app_read&#39; TO &#39;read_user1&#39;@&#39;localhost&#39;, &#39;read_user2&#39;@&#39;localhost&#39;;GRANT &#39;app_read&#39;, &#39;app_write&#39; TO &#39;rw_user1&#39;@&#39;localhost&#39;;    </code></pre><h1 id="方案二"><a href="#方案二" class="headerlink" title="方案二"></a>方案二</h1><pre><code>day02-老男孩教育-MySQL中级DBA课程-15K+第二章体系结构及基础管理（下）1. MySQL 逻辑结构（抽象）1.1 MySQL逻辑结构和Linux对比MySQL        Linux库           目录表           文件Linux 中一切皆文件。Linux中一切皆命令。MySQL 中一切皆表。一切皆SQL。1.2 MySQL 逻辑对象的特点库 ： 库名 + 库属性表 ： 列(字段：列名，列属性) + 行（记录）+ 表属性2. 物理结构    2.1  宏观    2.1.1 库     2.1.2 表 略 。 见图片。2.2  微观扇区、OS block、PAGE、extents 设计理念，都是为了能够程序  -----&gt; OS -----&gt; HDISK 从逻辑操作，到物理操作都能够保证尽可能“连续”IO。段 ： segments , 一个表就是一个段，由1-N个区构成。区 ： extents,  又被称之为“簇”，由64个连续的PAGE构成。默认大小1M。页 :  PAGE，MySQL 最小IO单元，默认大小 16KB，连续的4个OS block。OS block : 文件系统块，默认是4KB，连续的8个扇区。扇区     ： 默认512字节，连续的512字节长度的磁盘区域。3. MySQL基础管理   3.1 用户管理   3.1.1 作用# Linux 用户的作用？ 登录 管理对象（文件）# MySQL 用户作用？登录 管理对象（库、表）3.1.2 用户的定义？# Linux字符串表示用户名 oldguo oldboy# MySQL 用户名@&#39;白名单&#39;oldboy@&#39;白名单&#39;白名单？允许登录数据库的主机名单例子：     常用的： oldboy@&#39;localhost&#39;  -- 只允许本机oldboy登录oldboy@&#39;10.0.0.%&#39;   -- 允许10.0.0.0/24网段，以oldboy用户登录数据库oldboy@&#39;10.0.0.5%&#39;  -- 允许50-59段的地址，以oldboy用户登录数据库oldboy@&#39;10.0.0.0/255.255.254.0&#39; -- 允许10.0.0.0/23网段，以oldboy用户登录数据库    不常用：oldboy@&#39;%&#39;          -- 允许所有网络地址，以oldboy用户登录数据库oldboy@&#39;db02&#39;oldboy@&#39;oldboy.com&#39;3.1.3 用户管理  # 查询 mysql&gt; select user,host ,authentication_string ,plugin from mysql.user;+---------------+-----------+-------------------------------------------+-----------------------+| user          | host      | authentication_string                     | plugin                |+---------------+-----------+-------------------------------------------+-----------------------+| root          | localhost | *23AE809DDACAF96AF0FD78ED04B6A265E05AA257 | mysql_native_password || mysql.session | localhost | *THISISNOTAVALIDPASSWORDTHATCANBEUSEDHERE | mysql_native_password || mysql.sys     | localhost | *THISISNOTAVALIDPASSWORDTHATCANBEUSEDHERE | mysql_native_password |+---------------+-----------+-------------------------------------------+-----------------------+mysql&gt; desc mysql.user;    -- 查询表定义# 增加mysql&gt; create user IF NOT EXISTS oldboy@&#39;10.0.0.%&#39; identified by &#39;123&#39;;彩蛋： 8.0 + 版本新特性：    1. 必须先建用户，再授权。    以下命令不再被支持：    grant all on *.* to zabbix@&#39;%&#39; identified by &#39;123&#39;;    正确方法：     create user zabbix@&#39;%&#39; identified by &#39;123&#39;;    grant all on *.* to zabbix@&#39;%&#39;;    2. 8.0+ 版本，采用了全新的密码加密插件（caching_sha2_password）    部分场景下，需要将加密插件替换为5.7版本支持 mysql_native_password    例如：     主从    MHA    客户端软件    配置方法：     create user zabbix@&#39;%&#39; identified  by &#39;123&#39;;    grant all on *.* to zabbix@&#39;%&#39;;    替换为:     create user zabbix2@&#39;%&#39; identified  with mysql_native_password   by &#39;123&#39;;    grant all on *.* to zabbix2@&#39;%&#39;;# 修改     ## 修改密码      alter user oldboy@&#39;10.0.0.%&#39; identified by &#39;123456&#39;;    ## 8.0 修改密码插件    alter user zabbix@&#39;%&#39;  identified with mysql_native_password  by &#39;123456&#39;;    ## 用户锁定     ACCOUNT LOCK    ACCOUNT UNLOCK        mysql&gt; alter user test@&#39;10.0.0.%&#39; ACCOUNT LOCK;    mysql&gt; alter user test@&#39;10.0.0.%&#39; ACCOUNT UNLOCK;    ## 密码过期 （了解）    alter user oldboy@&#39;10.0.0.%&#39; PASSWORD EXPIRE;# 删除     mysql&gt; drop user test@&#39;10.0.0.%&#39;;3.2 权限 3.2.1 作用 #  Linux 中的作用 ？ 约束、控制 用户能够对 Linux 文件 做什么样的操作。权限属于文件的属性。# MySQL 中的作用约束、控制用户能够对 MySQL 中的对象（库、表）做什么样的操作。权限属于用户的属性。3.2.2 权限的定义？ #  Linux ：R 、W 、X4   2   1#  MySQL : 8.0 以前，以命令为授权粒度。8.0 以后，加入了role（角色）方式授权。通过以下命令，可以查看可授权的列表mysql&gt; show privileges;比较特殊的权限： ALL,包含了权限列表中，所有的权限，除了Grant optiongrant all privileges  on  .....3.2.3 权限管理 #  授权  ##  例子1：超级管理员用户（oldguo@&#39;10.0.0.%&#39;）授权   ## 5.7    mysql&gt; grant  all   on   *.*   to   oldguo@&#39;10.0.0.%&#39;   identified by &#39;123&#39;    with grant option;   grant  权限     on  权限范围  to  用户  identified by 密码  ;权限范围? 指的是，用户能够操作的对象是哪些。*.*          ====&gt;      chmod -R 777  /            全库级别，管理员用户oldboy.*     ====&gt;      chmod -R 777 /oldboy/*     单库级别，普通用户oldboy.t1    ====&gt;      chmod -R 777 /oldboy/t1##   例子2： 授权一个普通用户 test@&#39;10.0.0.%&#39; ,权限为 select 、update、delete、insert，范围：test.*mysql&gt; grant select,update,delete,insert on test.*  to test@&#39;10.0.0.%&#39; identified by &#39;123&#39;;# 查看授权 mysql&gt; show grants for test@&#39;10.0.0.%&#39;;# 回收权限注意： MySQL中不能重复授权，达到修改权限的目录。是相加关系。mysql&gt; revoke delete on test.* from &#39;test&#39;@&#39;10.0.0.%&#39; ;mysql&gt; show grants for test@&#39;10.0.0.%&#39;;扩展： 权限列表介绍------------------------+---------------------------------------+-------------------------------------------------------+| Privilege               | Context                               | Comment                                               |+-------------------------+---------------------------------------+---------------------------------------| Alter                   | Tables                                | To alter the table                                    || Alter routine           | Functions,Procedures                  | To alter or drop stored functions/procedures          || Create                  | Databases,Tables,Indexes              | To create new databases and tables                    || Create routine          | Databases                             | To use CREATE FUNCTION/PROCEDURE                      || Create temporary tables | Databases                             | To use CREATE TEMPORARY TABLE                         || Create view             | Tables                                | To create new views                                   || Create user             | Server Admin                          | To create new users                                   || Delete                  | Tables                                | To delete existing rows                               || Drop                    | Databases,Tables                      | To drop databases, tables, and views                  || Event                   | Server Admin                          | To create, alter, drop and execute events             || Execute                 | Functions,Procedures                  | To execute stored routines                            || File                    | File access on server                 | To read and write files on the server                 || Grant option            | Databases,Tables,Functions,Procedures | To give to other users those privileges you possess   || Index                   | Tables                                | To create or drop indexes                             || Insert                  | Tables                                | To insert data into tables                            || Lock tables             | Databases                             | To use LOCK TABLES (together with SELECT privilege)   || Process                 | Server Admin                          | To view the plain text of currently executing queries || Proxy                   | Server Admin                          | To make proxy user possible                           || References              | Databases,Tables                      | To have references on tables                          || Reload                  | Server Admin                          | To reload or refresh tables, logs and privileges      || Replication client      | Server Admin                          | To ask where the slave or master servers are          || Replication slave       | Server Admin                          | To read binary log events from the master             || Select                  | Tables                                | To retrieve rows from table                           || Show databases          | Server Admin                          | To see all databases with SHOW DATABASES              || Show view               | Tables                                | To see views with SHOW CREATE VIEW                    || Shutdown                | Server Admin                          | To shut down the server                               || Super                   | Server Admin                          | To use KILL thread, SET GLOBAL, CHANGE MASTER, etc.   || Trigger                 | Tables                                | To use triggers                                       || Create tablespace       | Server Admin                          | To create/alter/drop tablespaces  彩蛋：      8.0 中角色(role)功能    # 创建角色： CREATE ROLE &#39;app_developer&#39;, &#39;app_read&#39;, &#39;app_write&#39;;    # 角色授权：GRANT ALL ON app_db.* TO &#39;app_developer&#39;;GRANT SELECT ON app_db.* TO &#39;app_read&#39;;GRANT INSERT, UPDATE, DELETE ON app_db.* TO &#39;app_write&#39;;    # 创建用户： CREATE USER &#39;dev1&#39;@&#39;localhost&#39; IDENTIFIED BY &#39;dev1pass&#39;;CREATE USER &#39;read_user1&#39;@&#39;localhost&#39; IDENTIFIED BY &#39;read_user1pass&#39;;CREATE USER &#39;read_user2&#39;@&#39;localhost&#39; IDENTIFIED BY &#39;read_user2pass&#39;;CREATE USER &#39;rw_user1&#39;@&#39;localhost&#39; IDENTIFIED BY &#39;rw_user1pass&#39;;    # 授权用户角色GRANT &#39;app_developer&#39; TO &#39;dev1&#39;@&#39;localhost&#39;;GRANT &#39;app_read&#39; TO &#39;read_user1&#39;@&#39;localhost&#39;, &#39;read_user2&#39;@&#39;localhost&#39;;GRANT &#39;app_read&#39;, &#39;app_write&#39; TO &#39;rw_user1&#39;@&#39;localhost&#39;;    3.3 连接管理 3.3.1 自带的客户端程序连接# mysql      ## 参数 ： -u  -p -S -h -P -e &lt;  ### 本地连接（socket文件）前提：提前创建可以本地连接的用户，例如 :  test@&#39;localhost&#39;mysql&gt; grant all on *.* to test@&#39;localhost&#39; identified by &#39;123&#39;;[root@db01 data]# mysql     -utest      -p123     -S /tmp/mysql.sock说明:  什么情况下可以不加-S 参数？    1. 配置文件中 [mysql] 或者 [client]下已经制定socket正确位置。    2. 二进制版本的软件，如果服务器启动时，将socket存放到了/tmp/mysql.sock。### 远程登录 前提：提前创建能够用做远程登录的用户，例如：test1@&#39;10.0.0.%&#39;mysql&gt; grant all on *.* to test1@&#39;10.0.0.%&#39; identified by &#39;123&#39;;[root@db02 ~]# mysql -utest1 -p123     -h 10.0.0.51        -P 3306 ### -e  免交互执行MySQL 内置命令 [root@db01 tmp]# mysql -uroot -p123 -e &quot;select user,host from mysql.user;&quot; 2&gt;/dev/null### &lt;  导入SQL脚本[root@db01 ~]# mysql -uroot -p123 &lt; world.sql ## 内置功能help           :  获取客户端命令帮助\c (Ctrl+C)    :  结束上条命令运行Ctrl+l         :  清理屏幕Ctrl+d（\q）   :  退出会话\G             ： 格式化输出source         :  导入SQL脚本system         :  MySQL中调用操作系统命令use            ： 进入某个库# mysqladmin # mysqldump（备份章节） 3.3.2  开发工具# sqlyog # navicat# workbench </code></pre>]]></content>
      
      
      <categories>
          
          <category> mysql </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数据库 </tag>
            
            <tag> mysql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/2020/04/22/hello-world/"/>
      <url>/2020/04/22/hello-world/</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><pre class="line-numbers language-bash"><code class="language-bash">$ hexo new <span class="token string">"My New Post"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><pre class="line-numbers language-bash"><code class="language-bash">$ hexo server<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><pre class="line-numbers language-bash"><code class="language-bash">$ hexo generate<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><pre class="line-numbers language-bash"><code class="language-bash">$ hexo deploy<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html" target="_blank" rel="noopener">Deployment</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>小明同学为了战斗而生</title>
      <link href="/2020/02/16/sort-algorithms/"/>
      <url>/2020/02/16/sort-algorithms/</url>
      
        <content type="html"><![CDATA[<blockquote></blockquote><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><h2 id="性质汇总"><a href="#性质汇总" class="headerlink" title="性质汇总"></a>性质汇总</h2><blockquote></blockquote>]]></content>
      
      
      <categories>
          
          <category> 编程算法 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> leetcode </tag>
            
            <tag> 算法 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>第一章   MySQL 大纲介绍</title>
      <link href="/2020/02/16/di-yi-zhang-mysql-da-gang-jie-shao/"/>
      <url>/2020/02/16/di-yi-zhang-mysql-da-gang-jie-shao/</url>
      
        <content type="html"><![CDATA[<h2 id="1、官方定义的MySQL-DBA工作内容"><a href="#1、官方定义的MySQL-DBA工作内容" class="headerlink" title="1、官方定义的MySQL  DBA工作内容"></a>1、官方定义的MySQL  DBA工作内容</h2><pre class="line-numbers language-undefined"><code class="language-undefined">（1）运维DBA初级：各版本、各平台安装搭建、升级中级：体系结构原理、基础管理（启动关闭、初始化配置文件管理、多实例管理、用户权限管理、基本SQL（增删改查））、     日志管理、备份与恢复、主从复制（构建、状态监控） 高级：高可用（MGR、InnoDB Cluster）、高性能（优化）（2）开发DBA懂至少一门开发语言 ：JAVA、Python基本SQL语句深入学习（增删改查）、数据库结构设计（建模）高级SQL：存储过程、函数、触发器、视图、事件<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="2、MySQL课程-2019-03月-中级DBA要求（80-以上）"><a href="#2、MySQL课程-2019-03月-中级DBA要求（80-以上）" class="headerlink" title="2、MySQL课程-2019-03月-中级DBA要求（80%以上）"></a>2、MySQL课程-2019-03月-中级DBA要求（80%以上）</h2><pre class="line-numbers language-css"><code class="language-css">（<span class="token number">1</span>）MySQL <span class="token number">5.7</span> 安装部署（二进制）*****    编译自己扩展（<span class="token number">2</span>）MySQL升级步骤扩展 ***（<span class="token number">3</span>）MySQL<span class="token number">5.7</span> 体系结构原理 *****（<span class="token number">4</span>）MySQL基础管理  *****（<span class="token number">5</span>）基础SQL语句使用 *****（<span class="token number">6</span>）SQL高级应用  ***（<span class="token number">7</span>）Information_schema获取元数据 ***（<span class="token number">8</span>）索引、执行计划管理（基础优化）*****（<span class="token number">9</span>）存储引擎  *****（<span class="token number">10</span>）日志管理 *****（<span class="token number">11</span>）备份与恢复 ******（<span class="token number">12</span>）主从复制及架构演变 ******（<span class="token number">13</span>）传统的高可用及读写分离（MHA&amp;Atlas）****（<span class="token number">14</span>）传统分布式架构设计与实现-扩展（Mycat--->DBLE,DRDS）**（<span class="token number">15</span>）MySQL <span class="token number">5.7</span> 高可用及分布式架构-扩展（MGR,InnoDB Cluster）***（<span class="token number">16</span>）MySQL优化（安全、性能） ****（<span class="token number">17</span>）MySQL 监控（zabbix、Open-falcon）    **** <span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">)</span> <span class="token function">RDS</span><span class="token punctuation">(</span>阿里云课程<span class="token punctuation">)</span>    *****额外要会的：    Redis    mongodb     了解<span class="token punctuation">:</span>     PG    Oracle  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="3、DBA职业素养"><a href="#3、DBA职业素养" class="headerlink" title="3、DBA职业素养"></a>3、DBA职业素养</h2><hr><h3 id="3-1、人品"><a href="#3-1、人品" class="headerlink" title="3.1、人品"></a>3.1、人品</h3><pre class="line-numbers language-undefined"><code class="language-undefined">责任-----权利<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="3-2"><a href="#3-2" class="headerlink" title="3.2"></a>3.2</h3><h4 id="3-2-1、严谨"><a href="#3-2-1、严谨" class="headerlink" title="3.2.1、严谨"></a>3.2.1、严谨</h4><pre class="line-numbers language-rust"><code class="language-rust">磁带库<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">-></span>备份软件<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token number">17</span>楼数据库修改\删除类的命令时 再三考虑，而且要有理论或者实践的支撑<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h4 id="3-2-2-请收起你的好奇心！！！！！"><a href="#3-2-2-请收起你的好奇心！！！！！" class="headerlink" title="3.2.2 请收起你的好奇心！！！！！"></a>3.2.2 请收起你的好奇心！！！！！</h4><pre class="line-numbers language-undefined"><code class="language-undefined">注意规范:脱库？ 华住网（ip root 密码），“脱敏”!!!!!。学会保护自己!!!<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="3-3、细心"><a href="#3-3、细心" class="headerlink" title="3.3、细心"></a>3.3、细心</h3><pre class="line-numbers language-undefined"><code class="language-undefined">把最简单的事情做的最漂亮，最专业。不要怕成功的门很拥挤,因为很多人在半路就已经放弃了.                                           ----oldguo                     <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="3-4、心态"><a href="#3-4、心态" class="headerlink" title="3.4、心态"></a>3.4、心态</h3><pre class="line-numbers language-undefined"><code class="language-undefined">别惹事，出事别怕事<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="3-5、熟悉操作系统（精通）"><a href="#3-5、熟悉操作系统（精通）" class="headerlink" title="3.5、熟悉操作系统（精通）"></a>3.5、熟悉操作系统（精通）</h3><h3 id="3-6、熟悉公司业务"><a href="#3-6、熟悉公司业务" class="headerlink" title="3.6、熟悉公司业务"></a>3.6、熟悉公司业务</h3><pre class="line-numbers language-undefined"><code class="language-undefined">业务？    产品的功能    用户的行为(热功能,热数据)      <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="3-7、熟悉行业"><a href="#3-7、熟悉行业" class="headerlink" title="3.7、熟悉行业"></a>3.7、熟悉行业</h3><pre class="line-numbers language-cpp"><code class="language-cpp">熟悉行业发展趋势版本数据库产品类型https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>db<span class="token operator">-</span>engines<span class="token punctuation">.</span>com<span class="token operator">/</span>en<span class="token operator">/</span>ranking<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h3 id="3-8、喜欢数据库"><a href="#3-8、喜欢数据库" class="headerlink" title="3.8、喜欢数据库"></a>3.8、喜欢数据库</h3><pre class="line-numbers language-undefined"><code class="language-undefined">体验很重要<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="第二章-MySQL-介绍和安装"><a href="#第二章-MySQL-介绍和安装" class="headerlink" title="第二章: MySQL 介绍和安装"></a>第二章: MySQL 介绍和安装</h1><h2 id="1、什么是数据？"><a href="#1、什么是数据？" class="headerlink" title="1、什么是数据？"></a>1、什么是数据？</h2><pre class="line-numbers language-powershell"><code class="language-powershell">数据：文字、图片、视频。。。人类认知的数据表现方式计算机：二进制、16进制的机器语言基于数据的重要性和复杂性的不同，我们可能有不同的管理方式。哪些数据是适合存储到数据库的呢？重要性比较高的关系较复杂的数据<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="2、什么是数据库管理系统（DBMS）？"><a href="#2、什么是数据库管理系统（DBMS）？" class="headerlink" title="2、什么是数据库管理系统（DBMS）？"></a>2、什么是数据库管理系统（DBMS）？</h2><pre class="line-numbers language-powershell"><code class="language-powershell">RDBMS: 关系型数据库管理系统比较适合于<span class="token punctuation">,</span>安全级别要求高的数据以及关系较复杂的数据NoSQL:非关系型数据库管理系统适合于高性能存取数据<span class="token punctuation">,</span>一般是配合RDBMS进行使用的针对大数据处理分析<span class="token punctuation">,</span>分布式架构更加擅长<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="3、数据库管理系统种类"><a href="#3、数据库管理系统种类" class="headerlink" title="3、数据库管理系统种类"></a>3、数据库管理系统种类</h2><pre class="line-numbers language-powershell"><code class="language-powershell">RDBMS  ：MySQL 、Oracle、MSSQL（SQL Server）、PGNoSQL：Not Only SQL键<span class="token operator">-</span>值（key<span class="token operator">-</span>value）：Redis<span class="token punctuation">,</span> memcached文档（document）：Mongodb<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="4-数据库产品时代演变"><a href="#4-数据库产品时代演变" class="headerlink" title="4-数据库产品时代演变"></a>4-数据库产品时代演变</h2><pre class="line-numbers language-powershell"><code class="language-powershell">第一代数据库架构：    RDBMS 关系型数据库时代 ： 合的时代    代表产品 ：Oracle 、MSSQL 、MySQL第二代数据库架构：拆的时代    NoSQL  ： Not Only SQL 时代    代表产品： Redis 、MongoDB、ES 第三代数据库架构： 合的时代     NewSQL  ：新型数据库架构时代    代表产品：            阿里系列： OB 、PolarDB            Pincap  ： TiDB            google  ： spanner<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="5、MySQL简介及产品线"><a href="#5、MySQL简介及产品线" class="headerlink" title="5、MySQL简介及产品线"></a>5、MySQL简介及产品线</h2><h3 id="5-1-MySQL行业主流版本："><a href="#5-1-MySQL行业主流版本：" class="headerlink" title="5.1 MySQL行业主流版本："></a>5.1 MySQL行业主流版本：</h3><pre class="line-numbers language-css"><code class="language-css">    <span class="token number">5.6</span>      <span class="token number">5.7</span>        <span class="token number">8.0</span><span class="token punctuation">(</span>现在开始研究新特性<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="5-2-企业版本选择-MySQL分支版本-笔试题"><a href="#5-2-企业版本选择-MySQL分支版本-笔试题" class="headerlink" title="5.2 企业版本选择(MySQL分支版本),笔试题"></a>5.2 企业版本选择(MySQL分支版本),笔试题</h3><pre class="line-numbers language-undefined"><code class="language-undefined">Oracle:      MySQL官方版红帽  :      MariaDBPercona:      PerconaDB 面试题     1. 请你介绍你熟悉的数据库产品？   你们公司用了哪些数据库产品？    RDBMS ： MySQL  、Oracle  、PG、 MSSQL    NoSQL :  Redis  、MongoDB 、ES 、Memcached    云数据库：RDS    2. 你喜欢MySQL数据库吗？ 平常如何学习的？ MySQL需要具备哪些技能？    热爱。    官档 、源码、看书、视频、参加一些数据库大会。    技能： 大纲<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="5-3-版本选择建议要上新环境"><a href="#5-3-版本选择建议要上新环境" class="headerlink" title="5.3 版本选择建议要上新环境"></a>5.3 版本选择建议要上新环境</h3><h3 id="5-34MySQL-产品分支"><a href="#5-34MySQL-产品分支" class="headerlink" title="5.34MySQL 产品分支"></a>5.34MySQL 产品分支</h3><pre class="line-numbers language-powershell"><code class="language-powershell">3<span class="token punctuation">.</span> Oracle MySQL  ：C版 、 E版 、Cluster版Percona MySQL ：最接近于Oracle MySQL MariaDB       ：从5<span class="token punctuation">.</span>5<span class="token operator">+</span> 以后，10<span class="token punctuation">.</span>x <span class="token operator">+</span>版本阿里：  RDS <span class="token keyword">for</span> MySQL 腾讯：  TDSQL <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-css"><code class="language-css"><span class="token number">1.</span>一般选择官方主流版本<span class="token punctuation">:</span><span class="token number">5.6</span>,<span class="token number">5.7</span> <span class="token number">2.</span>GA（稳定发布版）<span class="token number">3.6</span>-<span class="token number">12</span>月的产品版本--------------------------<span class="token number">4.</span> MySQL的企业版本选择<span class="token number">5.7</span>  ： 一般选择最新GA版本  <span class="token number">5.7.26</span>   <span class="token number">5.7.28</span> <span class="token number">5.6</span>  ： GA <span class="token number">6</span>-<span class="token number">12</span>月之间的版本 <span class="token number">8.0</span>  ： 一般选择最新GA版本  <span class="token number">8.0.17</span>+<span class="token number">5.6</span> 版本 <span class="token number">2020</span> <span class="token number">10</span>月  常规、扩展服务全部停止<span class="token number">5.7</span> 版本 <span class="token number">2021</span> <span class="token number">1</span>月   常规服务停止<span class="token number">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="5-4-课程版本："><a href="#5-4-课程版本：" class="headerlink" title="5.4 课程版本："></a>5.4 课程版本：</h3><pre class="line-numbers language-css"><code class="language-css"><span class="token number">5.7.20</span>  二进制安装，其他安装方式自己扩展<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="5-5-如何获取MySQL软件"><a href="#5-5-如何获取MySQL软件" class="headerlink" title="5.5 如何获取MySQL软件"></a>5.5 如何获取MySQL软件</h3><pre class="line-numbers language-css"><code class="language-css">企业版：Enterprise  , 互联网行业一般不选择<span class="token number">.</span>社区版本：选择源码包：source code    <span class="token number">.</span>tar<span class="token number">.</span>gz   通用二进制   面试题<span class="token punctuation">:</span>你们公司用什么版本数据库? 具体什么小版本号?<span class="token number">5.6.20</span> <span class="token number">5.6.34</span> <span class="token number">5.6.36</span>  <span class="token number">5.6.38</span>  <span class="token number">5.6.40</span>    <span class="token number">5.7.18</span>  <span class="token number">5.7.20</span>  <span class="token number">5.7.22</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>获取软件</p><pre><code>https://downloads.mysql.com/archives/[root@db01 app]# md5sum  mysql-5.7.28-linux-glibc2.12-x86_64.tar.gz1daa30a32b99a92062f481bd3ef8694c  mysql-5.7.28-linux-glibc2.12-x86_64.tar.gz[root@db01 app]# MD5: 1daa30a32b99a92062f481bd3ef8694cdiff a  b  </code></pre><h2 id="5、-MySQL二进-制安装"><a href="#5、-MySQL二进-制安装" class="headerlink" title="5、==MySQL二进==制安装"></a>5、==MySQL二进==制安装</h2><h3 id="5-1-创建软件目录"><a href="#5-1-创建软件目录" class="headerlink" title="5.1.创建软件目录:"></a>5.1.创建软件目录:</h3><pre class="line-numbers language-powershell"><code class="language-powershell">6<span class="token punctuation">.</span>2<span class="token punctuation">.</span>5 清理遗留环境 <span class="token comment" spellcheck="true"># 检查是否有mariadb相关软件</span><span class="token namespace">[root@db01 ~]</span><span class="token comment" spellcheck="true"># rpm -qa|grep mariadb</span><span class="token comment" spellcheck="true"># 如果有，清理掉 </span>yum remove mariadb<span class="token operator">-</span>libs <span class="token operator">-</span>y <span class="token comment" spellcheck="true"># 删掉/etc/my.cnf 已有的配置文件 </span><span class="token function">rm</span> <span class="token operator">-</span>rf <span class="token operator">/</span>etc<span class="token operator">/</span>my<span class="token punctuation">.</span>cnf 6<span class="token punctuation">.</span>2<span class="token punctuation">.</span>6 安装依赖包 <span class="token namespace">[root@db01 ~]</span><span class="token comment" spellcheck="true"># yum install -y libaio-devel </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-csharp"><code class="language-csharp"><span class="token punctuation">[</span>root@db01 <span class="token operator">~</span><span class="token punctuation">]</span># mkdir <span class="token operator">-</span>p  <span class="token operator">/</span>data<span class="token operator">/</span>app 上传软件到此目录<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="5-2-解压并改名为mysql"><a href="#5-2-解压并改名为mysql" class="headerlink" title="5.2. 解压并改名为mysql"></a>5.2. 解压并改名为mysql</h3><pre class="line-numbers language-ruby"><code class="language-ruby"><span class="token punctuation">[</span>root<span class="token variable">@db01</span> app<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># mv mysql-5.7.20-linux-glibc2.12-x86_64 mysql</span><span class="token punctuation">[</span>root<span class="token variable">@China</span> <span class="token operator">/</span>data<span class="token operator">/</span>app<span class="token punctuation">]</span> <span class="token comment" spellcheck="true"># ln -s /data/app/mysql-5.6.46/  /data/app/mysql</span><span class="token punctuation">[</span>root<span class="token variable">@db01</span> app<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># ls -l /app/mysql/</span>total <span class="token number">36</span>drwxr<span class="token operator">-</span>xr<span class="token operator">-</span>x  <span class="token number">2</span> root root   <span class="token number">4096</span> <span class="token constant">Mar</span>  <span class="token number">4</span> <span class="token number">14</span><span class="token punctuation">:</span><span class="token number">55</span> bin<span class="token operator">-</span>rw<span class="token operator">-</span>r<span class="token operator">--</span>r<span class="token operator">--</span>  <span class="token number">1</span> <span class="token number">7161</span> <span class="token number">31415</span> <span class="token number">17987</span> <span class="token constant">Sep</span> <span class="token number">13</span>  <span class="token number">2017</span> <span class="token constant">COPYING</span>drwxr<span class="token operator">-</span>xr<span class="token operator">-</span>x  <span class="token number">2</span> root root     <span class="token number">55</span> <span class="token constant">Mar</span>  <span class="token number">4</span> <span class="token number">14</span><span class="token punctuation">:</span><span class="token number">55</span> docsdrwxr<span class="token operator">-</span>xr<span class="token operator">-</span>x  <span class="token number">3</span> root root   <span class="token number">4096</span> <span class="token constant">Mar</span>  <span class="token number">4</span> <span class="token number">14</span><span class="token punctuation">:</span><span class="token number">55</span> includedrwxr<span class="token operator">-</span>xr<span class="token operator">-</span>x  <span class="token number">5</span> root root    <span class="token number">229</span> <span class="token constant">Mar</span>  <span class="token number">4</span> <span class="token number">14</span><span class="token punctuation">:</span><span class="token number">55</span> libdrwxr<span class="token operator">-</span>xr<span class="token operator">-</span>x  <span class="token number">4</span> root root     <span class="token number">30</span> <span class="token constant">Mar</span>  <span class="token number">4</span> <span class="token number">14</span><span class="token punctuation">:</span><span class="token number">55</span> man<span class="token operator">-</span>rw<span class="token operator">-</span>r<span class="token operator">--</span>r<span class="token operator">--</span>  <span class="token number">1</span> <span class="token number">7161</span> <span class="token number">31415</span>  <span class="token number">2478</span> <span class="token constant">Sep</span> <span class="token number">13</span>  <span class="token number">2017</span> <span class="token constant">README</span>drwxr<span class="token operator">-</span>xr<span class="token operator">-</span>x <span class="token number">28</span> root root   <span class="token number">4096</span> <span class="token constant">Mar</span>  <span class="token number">4</span> <span class="token number">14</span><span class="token punctuation">:</span><span class="token number">55</span> sharedrwxr<span class="token operator">-</span>xr<span class="token operator">-</span>x  <span class="token number">2</span> root root     <span class="token number">90</span> <span class="token constant">Mar</span>  <span class="token number">4</span> <span class="token number">14</span><span class="token punctuation">:</span><span class="token number">55</span> support<span class="token operator">-</span>files<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>修改环境变量:</p><pre class="line-numbers language-bash"><code class="language-bash">vim /etc/profile<span class="token punctuation">[</span>root@China /data/app/mysql<span class="token punctuation">]</span> <span class="token comment" spellcheck="true"># export  PATH=/data/app/mysql/bin:$PATH</span><span class="token punctuation">[</span>root@db01 bin<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># source /etc/profile</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="5-3-建立mysql用户和组-如果已有可忽略"><a href="#5-3-建立mysql用户和组-如果已有可忽略" class="headerlink" title="5.3. 建立mysql用户和组(如果已有可忽略)"></a>5.3. 建立mysql用户和组(如果已有可忽略)</h3><pre class="line-numbers language-undefined"><code class="language-undefined"> useradd mysql <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="5-4-创建相关目录并修改权限"><a href="#5-4-创建相关目录并修改权限" class="headerlink" title="5.4. 创建相关目录并修改权限"></a>5.4. 创建相关目录并修改权限</h3><pre class="line-numbers language-kotlin"><code class="language-kotlin"><span class="token punctuation">[</span><span class="token label symbol">root@</span>db01 ~<span class="token punctuation">]</span># mkdir <span class="token operator">-</span>p <span class="token operator">/</span><span class="token keyword">data</span><span class="token operator">/</span><span class="token number">3306</span><span class="token operator">/</span><span class="token keyword">data</span>  #数据目录<span class="token punctuation">[</span><span class="token label symbol">root@</span>db01 ~<span class="token punctuation">]</span># useradd  mysql <span class="token operator">-</span>M <span class="token operator">-</span>s <span class="token operator">/</span>sbin<span class="token operator">/</span>nologin <span class="token punctuation">[</span><span class="token label symbol">root@</span>db01 ~<span class="token punctuation">]</span># chown <span class="token operator">-</span>R mysql<span class="token punctuation">.</span>mysql <span class="token operator">/</span><span class="token keyword">data</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="5-5-初始化数据（建库）"><a href="#5-5-初始化数据（建库）" class="headerlink" title="5.5 初始化数据（建库）"></a>5.5 初始化数据（建库）</h3><p>方法一:</p><pre class="line-numbers language-csharp"><code class="language-csharp">初始化数据，初始化管理员的临时密码mysqld <span class="token operator">--</span>initialize  <span class="token operator">--</span>user<span class="token operator">=</span>mysql <span class="token operator">--</span>basedir<span class="token operator">=</span><span class="token operator">/</span>app<span class="token operator">/</span>mysql <span class="token operator">--</span>datadir<span class="token operator">=</span><span class="token operator">/</span>data<span class="token operator">/</span>mysql   <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token number">6.2</span><span class="token punctuation">.</span><span class="token number">8</span> 初始化数据<span class="token preprocessor property"># 5.7+ 版本初始化 ：</span>mysqld       <span class="token operator">--</span>initialize<span class="token operator">-</span>insecure      <span class="token operator">--</span>user<span class="token operator">=</span>mysql      <span class="token operator">--</span>basedir<span class="token operator">=</span><span class="token operator">/</span>data<span class="token operator">/</span>app<span class="token operator">/</span>mysql        <span class="token operator">--</span>datadir<span class="token operator">=</span><span class="token operator">/</span>data<span class="token operator">/</span><span class="token number">3306</span><span class="token operator">/</span>data 有可能的报错：     <span class="token number">1</span><span class="token punctuation">.</span> libaio<span class="token operator">-</span>devel     <span class="token number">2</span><span class="token punctuation">.</span>  <span class="token punctuation">[</span>ERROR<span class="token punctuation">]</span> <span class="token operator">--</span>initialize specified but the data directory has files <span class="token keyword">in</span> it<span class="token punctuation">.</span> Aborting<span class="token punctuation">.</span>    rm <span class="token operator">-</span>rf <span class="token operator">/</span>data<span class="token operator">/</span><span class="token number">3306</span><span class="token operator">/</span>data<span class="token operator">/</span><span class="token operator">*</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https:////upload-images.jianshu.io/upload_images/16956686-35999407e3216f9b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p>image.png</p><pre class="line-numbers language-undefined"><code class="language-undefined">报错原因: Linux系统中缺少libaio-devel 软件包解决:yum install -y libaio-devel<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><img src="https:////upload-images.jianshu.io/upload_images/16956686-28004810e36f801b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1004/format/webp" alt="img"></p><p>image.png</p><pre class="line-numbers language-kotlin"><code class="language-kotlin">报错原因<span class="token operator">:</span>在<span class="token operator">/</span><span class="token keyword">data</span><span class="token operator">/</span>mysql 存在文件解决<span class="token operator">:</span>\rm <span class="token operator">-</span>rf <span class="token operator">/</span><span class="token keyword">data</span><span class="token operator">/</span>mysql<span class="token operator">/</span><span class="token operator">*</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><strong>新特性重要说明:</strong><br> <strong>5.7开始,MySQL加入了全新的 密码的安全机制:</strong><br> <strong>1.初始化完成后,会生成临时密码(显示到屏幕上,并且会往日志中记一份)</strong><br> <strong>2.密码复杂度:长度:超过12位? 复杂度:字符混乱组合</strong><br> <strong>3.密码过期时间180天</strong></p><pre class="line-numbers language-shell"><code class="language-shell">方法二 :初始化数据，初始化管理员的密码为空[root@China /data/app] # rm -rf /data/3306/data/*[root@db01 ~]# mysqld --initialize-insecure  --user=mysql --basedir=/app/mysql --datadir=/data/mysql2019-04-18T03:37:44.042348Z 1 [Warning] root@localhost is created with an empty password ! Please consider switching off the --initialize-insecure option.[root@db01 ~]# [root@db01 ~]# cd /data/mysql/<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>注释：5.6初始化的区别</strong></p><pre class="line-numbers language-jsx"><code class="language-jsx"><span class="token punctuation">[</span>root@China <span class="token operator">/</span>data<span class="token operator">/</span>app<span class="token punctuation">]</span> # <span class="token operator">/</span>data<span class="token operator">/</span>app<span class="token operator">/</span>mysql<span class="token operator">/</span>scripts<span class="token operator">/</span>mysql_install_db   <span class="token operator">--</span>user<span class="token operator">=</span>mysql <span class="token operator">--</span>basedir<span class="token operator">=</span><span class="token operator">/</span>data<span class="token operator">/</span>app<span class="token operator">/</span>mysql <span class="token operator">--</span>datadir<span class="token operator">=</span><span class="token operator">/</span>data<span class="token operator">/</span><span class="token number">3306</span><span class="token operator">/</span>data <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="5-6-书写默认配置文件"><a href="#5-6-书写默认配置文件" class="headerlink" title="5.6 书写默认配置文件"></a>5.6 书写默认配置文件</h3><pre class="line-numbers language-jsx"><code class="language-jsx">vim <span class="token regex">/etc/my</span><span class="token punctuation">.</span>cnf<span class="token punctuation">[</span>mysqld<span class="token punctuation">]</span>user<span class="token operator">=</span>mysqlbasedir<span class="token operator">=</span><span class="token operator">/</span>app<span class="token operator">/</span>mysqldatadir<span class="token operator">=</span><span class="token operator">/</span>data<span class="token operator">/</span>mysqlserver_id<span class="token operator">=</span><span class="token number">6</span>port<span class="token operator">=</span><span class="token number">3306</span>socket<span class="token operator">=</span><span class="token operator">/</span>tmp<span class="token operator">/</span>mysql<span class="token punctuation">.</span>sock<span class="token punctuation">[</span>mysql<span class="token punctuation">]</span>socket<span class="token operator">=</span><span class="token operator">/</span>tmp<span class="token operator">/</span>mysql<span class="token punctuation">.</span>sockprompt<span class="token operator">=</span><span class="token number">3306</span> <span class="token punctuation">[</span>\\d<span class="token punctuation">]</span><span class="token operator">></span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>              <span class="token punctuation">[</span>mysqld<span class="token punctuation">]</span>user<span class="token operator">=</span>mysqlbasedir<span class="token operator">=</span><span class="token operator">/</span>data<span class="token operator">/</span>app<span class="token operator">/</span>mysqldatadir<span class="token operator">=</span><span class="token operator">/</span>data<span class="token operator">/</span><span class="token number">3306</span><span class="token operator">/</span>datasocket<span class="token operator">=</span><span class="token operator">/</span>tmp<span class="token operator">/</span>mysql<span class="token punctuation">.</span>sock<span class="token punctuation">[</span>mysql<span class="token punctuation">]</span>socket<span class="token operator">=</span><span class="token operator">/</span>tmp<span class="token operator">/</span>mysql<span class="token punctuation">.</span>sock<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="5-7-配置启动脚本"><a href="#5-7-配置启动脚本" class="headerlink" title="5.7 配置启动脚本:"></a>5.7 配置启动脚本:</h3><pre class="line-numbers language-csharp"><code class="language-csharp"><span class="token punctuation">[</span>root@db01 mysql<span class="token punctuation">]</span># cd <span class="token operator">/</span>app<span class="token operator">/</span>mysql<span class="token operator">/</span>support<span class="token operator">-</span>files<span class="token punctuation">[</span>root@db01 support<span class="token operator">-</span>files<span class="token punctuation">]</span># <span class="token punctuation">.</span><span class="token operator">/</span>mysql<span class="token punctuation">.</span>server startStarting MySQL<span class="token punctuation">.</span>Logging to <span class="token string">'/data/mysql/db01.err'</span><span class="token punctuation">.</span> SUCCESS<span class="token operator">!</span> cp mysql<span class="token punctuation">.</span>server    <span class="token operator">/</span>etc<span class="token operator">/</span>init<span class="token punctuation">.</span>d<span class="token operator">/</span>mysqld  <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>    <span class="token number">6.2</span><span class="token punctuation">.</span><span class="token number">10</span> 准备启动脚本，启动数据库<span class="token punctuation">[</span>root@db01 data<span class="token punctuation">]</span># cp <span class="token operator">/</span>data<span class="token operator">/</span>app<span class="token operator">/</span>mysql<span class="token operator">/</span>support<span class="token operator">-</span>files<span class="token operator">/</span>mysql<span class="token punctuation">.</span>server  <span class="token operator">/</span>etc<span class="token operator">/</span>init<span class="token punctuation">.</span>d<span class="token operator">/</span>mysqld <span class="token punctuation">[</span>root@db01 data<span class="token punctuation">]</span># chkconfig <span class="token operator">--</span><span class="token keyword">add</span> mysqld<span class="token punctuation">[</span>root@db01 data<span class="token punctuation">]</span># systemctl start mysqld<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="5-8-使用systemd管理mysql"><a href="#5-8-使用systemd管理mysql" class="headerlink" title="5.8 使用systemd管理mysql"></a>5.8 使用systemd管理mysql</h3><pre class="line-numbers language-csharp"><code class="language-csharp">vim <span class="token operator">/</span>etc<span class="token operator">/</span>systemd<span class="token operator">/</span>system<span class="token operator">/</span>mysqld<span class="token punctuation">.</span>service <span class="token punctuation">[</span>Unit<span class="token punctuation">]</span>Description<span class="token operator">=</span>MySQL ServerDocumentation<span class="token operator">=</span>man<span class="token punctuation">:</span><span class="token function">mysqld</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span>Documentation<span class="token operator">=</span>http<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>dev<span class="token punctuation">.</span>mysql<span class="token punctuation">.</span>com<span class="token operator">/</span>doc<span class="token operator">/</span>refman<span class="token operator">/</span>en<span class="token operator">/</span><span class="token keyword">using</span><span class="token operator">-</span>systemd<span class="token punctuation">.</span>htmlAfter<span class="token operator">=</span>network<span class="token punctuation">.</span>targetAfter<span class="token operator">=</span>syslog<span class="token punctuation">.</span>target<span class="token punctuation">[</span>Install<span class="token punctuation">]</span>WantedBy<span class="token operator">=</span>multi<span class="token operator">-</span>user<span class="token punctuation">.</span>target<span class="token punctuation">[</span>Service<span class="token punctuation">]</span>User<span class="token operator">=</span>mysqlGroup<span class="token operator">=</span>mysqlExecStart<span class="token operator">=</span><span class="token operator">/</span>app<span class="token operator">/</span>mysql<span class="token operator">/</span>bin<span class="token operator">/</span>mysqld <span class="token operator">--</span>defaults<span class="token operator">-</span>file<span class="token operator">=</span><span class="token operator">/</span>etc<span class="token operator">/</span>my<span class="token punctuation">.</span>cnfLimitNOFILE <span class="token operator">=</span> <span class="token number">5000</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>注意：将原来模式启动mysqld先关闭，然后再用systemd管理。</p><pre class="line-numbers language-undefined"><code class="language-undefined">systemctl  start/stop/restart/status   mysqld<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="6-安装后的简单管理"><a href="#6-安装后的简单管理" class="headerlink" title="6. 安装后的简单管理"></a>6. 安装后的简单管理</h2><pre class="line-numbers language-css"><code class="language-css">[root@db<span class="token number">01</span> ~]# mysqladmin -uroot -p password <span class="token number">123</span>Enter <span class="token property">password</span><span class="token punctuation">:</span> <span class="token property">mysqladmin</span><span class="token punctuation">:</span> [Warning] Using a password on the command line interface can be insecure<span class="token number">.</span><span class="token property">Warning</span><span class="token punctuation">:</span> Since password will be sent to server in plain text, use ssl connection to ensure password safety<span class="token number">.</span><span class="token number">5.6</span>版本<span class="token punctuation">:</span>select user,password,host from mysql<span class="token number">.</span>user<span class="token punctuation">;</span><span class="token number">5.7</span> 中用户基本信息select user,authentication_string,host from mysql<span class="token number">.</span>user<span class="token punctuation">;</span>desc  mysql<span class="token number">.</span>user<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>小结:<br> 1.版本 (主流版本的GA时间了解一下)</p><pre class="line-numbers language-css"><code class="language-css"><span class="token number">5.6</span> <span class="token number">5.7</span> <span class="token number">5.6.38</span>   <span class="token number">5.7.20</span> <span class="token number">20170913</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> 初始化方式变了mysql_install_db   mysqld  --initialize-insecure<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> 用户安全<span class="token number">12</span>位<span class="token number">180</span><span class="token number">4</span>种复杂度<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>密码字段authentication_strings<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>2.安装方法:</p><pre class="line-numbers language-undefined"><code class="language-undefined">二进制源码yum <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>3.建库(初始化数据库)</p><pre class="line-numbers language-jsx"><code class="language-jsx">mysqld <span class="token operator">--</span>intialize<span class="token operator">-</span>insecure <span class="token operator">--</span>user<span class="token operator">=</span>mysql <span class="token operator">--</span>basedir<span class="token operator">=</span><span class="token operator">/</span>app<span class="token operator">/</span>mysql <span class="token operator">--</span>datadir<span class="token operator">=</span><span class="token operator">/</span>data<span class="token operator">/</span>mysql <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>4.简易的配制文件/etc/my.cnf</p><pre class="line-numbers language-undefined"><code class="language-undefined">user basedirdatadir server_idportsocket <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ol><li>管理员密码</li></ol><pre class="line-numbers language-undefined"><code class="language-undefined">mysqladmin -uroot -p password xx<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="第三章节-MySQL体系结构及基础管理"><a href="#第三章节-MySQL体系结构及基础管理" class="headerlink" title="第三章节 MySQL体系结构及基础管理"></a>第三章节 MySQL体系结构及基础管理</h1><pre><code>1. MySQL 的C/S模型工作结构Client：     自带命令    第三方工具    APIServer :     TCP/IP    Unix Socket2. MySQL 的实例结构实例： mysqld进程 + Master thread + worker thread(IO\SQL\Purge...)+ 预分配内存结构公司： BOSS + 经理 + 员工 + 办公区域   3. mysqld 核心程序工作原理3.1  server 层      ----&gt; Linux  OS3.1.1 连接器 3.1.2 SQL层3.2  engine 层      ----&gt; 文件系统</code></pre><h1 id="终结篇"><a href="#终结篇" class="headerlink" title="终结篇"></a>终结篇</h1><pre><code>第一章节 MySQL 的介绍及规划实施1. 数据库产品时代演变第一代数据库架构：    RDBMS 关系型数据库时代 ： 合的时代    代表产品 ：Oracle 、MSSQL 、MySQL第二代数据库架构：拆的时代    NoSQL  ： Not Only SQL 时代    代表产品： Redis 、MongoDB、ES 第三代数据库架构： 合的时代     NewSQL  ：新型数据库架构时代    代表产品：            阿里系列： OB 、PolarDB            Pincap  ： TiDB            google  ： spanner2. 熟悉数据库行业 定期参加数据库大会db-engines.com http://www.itdks.com/休息20分钟：10:50继续彩蛋： 面试题     1. 请你介绍你熟悉的数据库产品？   你们公司用了哪些数据库产品？    RDBMS ： MySQL  、Oracle  、PG、 MSSQL    NoSQL :  Redis  、MongoDB 、ES 、Memcached    云数据库：RDS    2. 你喜欢MySQL数据库吗？ 平常如何学习的？ MySQL需要具备哪些技能？    热爱。    官档 、源码、看书、视频、参加一些数据库大会。    技能： 大纲3. MySQL 产品分支Oracle MySQL  ：C版 、 E版 、Cluster版Percona MySQL ：最接近于Oracle MySQL MariaDB       ：从5.5+ 以后，10.x +版本阿里：  RDS for MySQL 腾讯：  TDSQL ....4. MySQL的企业版本选择5.7  ： 一般选择最新GA版本  5.7.26   5.7.28 5.6  ： GA 6-12月之间的版本 8.0  ： 一般选择最新GA版本  8.0.17+5.6 版本 2020 10月  常规、扩展服务全部停止5.7 版本 2021 1月   常规服务停止.5. 获取软件https://downloads.mysql.com/archives/[root@db01 app]# md5sum  mysql-5.7.28-linux-glibc2.12-x86_64.tar.gz1daa30a32b99a92062f481bd3ef8694c  mysql-5.7.28-linux-glibc2.12-x86_64.tar.gz[root@db01 app]# MD5: 1daa30a32b99a92062f481bd3ef8694cdiff a  b  6. 手撕 MySQL 5728 二进制版本规划和实施6.1 准备Linux服务器 克隆：Centos 7.6  1核  2G  100G 虚拟机环境IP： 10.0.0.51/24 hostname : db01 防火墙： 关闭 selinux ： 关闭 6.2 上传软件到指定目录6.2.1 创建指定目录mkdir -p  /data/app 6.2.2 上传软件mysql-5.7.28-linux-glibc2.12-x86_64.tar.gz6.2.3 解压制作软连接[root@db01 app]# tar xf mysql-5.7.28-linux-glibc2.12-x86_64.tar.gz [root@db01 app]# ln -s mysql-5.7.28-linux-glibc2.12-x86_64 mysql6.2.4 修改环境变量echo &quot;export PATH=$PATH:/opt/src/mysql/bin&quot; &gt;&gt;/etc/profile# 生效配置 source /etc/profile  # 验证[root@db01 bin]# mysql -Vmysql  Ver 14.14 Distrib 5.7.28, for linux-glibc2.12 (x86_64) using  EditLine wrapper6.2.5 清理遗留环境 # 检查是否有mariadb相关软件[root@db01 ~]# rpm -qa|grep mariadb# 如果有，清理掉 yum remove mariadb-libs -y # 删掉/etc/my.cnf 已有的配置文件 rm -rf /etc/my.cnf 6.2.6 安装依赖包 [root@db01 ~]# yum install -y libaio-devel 6.2.7 创建相关目录、用户，并做授权[root@db01 ~]# mkdir -p /data/3306/data [root@db01 ~]# useradd mysql [root@db01 ~]# chown -R mysql.mysql /data6.2.8 初始化数据# 5.7+ 版本初始化 ：mysqld       --initialize-insecure      --user=mysql      --basedir=/data/app/mysql        --datadir=/data/3306/data 有可能的报错：     1. libaio-devel     2.  [ERROR] --initialize specified but the data directory has files in it. Aborting.    rm -rf /data/3306/data/*6.2.9 准备配置文件 vim /etc/my.cnf [mysqld]user=mysqlbasedir=/data/app/mysqldatadir=/data/3306/datasocket=/tmp/mysql.sock[mysql]socket=/tmp/mysql.sock6.2.10 准备启动脚本，启动数据库[root@db01 data]# cp /data/app/mysql/support-files/mysql.server  /etc/init.d/mysqld [root@db01 data]# chkconfig --add mysqld[root@db01 data]# systemctl start mysqld彩蛋：       1. 5.6 和 5.7 在初始化方面的不同？    5.6 版本：          /data/app/mysql56/scripts/mysql_install_db   --user=mysql --basedir=/data/app/mysql --datadir=/data/3306/data     初始化完成之后，启动数据库，无密码登陆    5.7 版本：          mysqld   --initialize-insecure   --user=mysql   --basedir=/data/app/mysql  --datadir=/data/3306/data    初始化完成之后，启动数据库，无密码登陆    2. 5.7+ 两种初始化方式     （1） --initialize-insecure （不安全）     mysqld   --initialize-insecure   --user=mysql   --basedir=/data/app/mysql  --datadir=/data/3306/data     结果： 初始化完成之后，启动数据库，无密码登陆    （2） --initialize （安全）     mysqld   --initialize    --user=mysql   --basedir=/data/app/mysql  --datadir=/data/3306/data     结果： 初始化完成之后，生成临时密码（4种复杂度、12位），不能用作管理数据库，需要第一次使用之前改掉这个密码。     mysql -uroot -p     Enter password: 此处填写临时密码：     2020-04-21T06:49:15.881987Z 1 [Note] A temporary password is generated for root@localhost: +fCQiY1x:rH-     mysql&gt; alter user root@&#39;localhost&#39; identified by &#39;123&#39;;    [root@db01 data]# mysql -uroot -p123    3. 设置管理员初始密码    [root@db01 data]# mysqladmin     -uroot     -p   password      123    4. 编译安装：源码包       cmake        make         make install        什么时候用？        测试、调试。       二次开发---》 编译安装        定制---》源码包或者配置文件。       定制rpm包---》源码包第一章节作业：      1. 部署5.6版本    2. 部署8.0版本第二章节 MySQL体系结构及基础管理1. MySQL 的C/S模型工作结构Client：     自带命令    第三方工具    APIServer :     TCP/IP    Unix Socket2. MySQL 的实例结构实例： mysqld进程 + Master thread + worker thread(IO\SQL\Purge...)+ 预分配内存结构公司： BOSS + 经理 + 员工 + 办公区域   3. mysqld 核心程序工作原理3.1  server 层      ----&gt; Linux  OS3.1.1 连接器 3.1.2 SQL层3.2  engine 层      ----&gt; 文件系统</code></pre><p><img src="image-20200423083500092.png" alt="image-20200423083500092"></p>]]></content>
      
      
      <categories>
          
          <category> mysql </category>
          
      </categories>
      
      
        <tags>
            
            <tag> mysql </tag>
            
            <tag> leetcode </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
